@mixin fa_background_icon($icon_name:  $icon_name,
                          $icon_color: $icon_color,
                          $width:      false,
                          $height:     false,
                          $horizontal: center,
                          $h_nudge:    '',
                          $vertical:   center,
                          $v_nudge:    '',
                          $icon_root:  $fa_icon_root) {

  background-image:    url(#{$icon_root}#{$icon_color}/#{$icon_name}.svg);
  background-repeat:   no-repeat;
  background-size:     $width $height;
  background-position: $horizontal
                       #{if($horizontal == center, '', $h_nudge)}
                       $vertical
                       #{if($vertical   == center, '', $v_nudge)};
}

@mixin fa_pseudo_icon($icon_name,
                      $icon_color,
                      $width:         false,
                      $height:        false,
                      $element:       before,
                      $padding:       0.5em,
                      $border_radius: false,
                      $outer_nudge:   0,
                      $inner_nudge:   0,
                      $position:      left,
                      $fill:          transparent,
                      $icon_root:     $fa_icon_root) {

  $width:  if($width,  $width,  auto);
  $height: if($height, $height, auto);
  $size:   false;

  @if type-of($height) == number and type-of($width) == number {
    $size: max($width, $height);
  } @else if type-of($height) == number {
    $size: $height;
  } @else if type-of($width) == number {
    $size: $width;
  } @else {
    @error "height and/or width must be a numeric unit such as '1rem' or '50px'";
  }

  $centering_direction: top;
  $centering_dimention: height;

  @if $position == top or $position == bottom {
    $centering_direction: left;
    $centering_dimention: width;
  }

  $size_forumula: "(#{$size} + (#{$padding} * 2))";

  padding-#{$position}:        calc(#{$size_forumula} + #{$outer_nudge} + #{$inner_nudge});
  min-#{$centering_dimention}: calc(#{$size_forumula});
  position:                    relative;

  &::#{$element} {
    @include fa_background_icon(
               $icon_name:  $icon_name,
               $icon_color: $icon_color,
               $width:      $width,
               $height:     $height,
               $icon_root:  $fa_icon_root
             );

    content:          '';
    display:          block;
    background-color: $fill;
    width:            calc(#{$size_forumula});
    height:           calc(#{$size_forumula});
    border-radius:    if($border_radius, $border_radius, calc(#{$size_forumula} / 2));
    position:         absolute;
    #{$position}:     $outer_nudge;

    #{$centering_direction}:        50%;
    margin-#{$centering_direction}: calc(-1 * #{$size_forumula} / 2)
  }
}
